# æŒ‡é’ˆ

ä»€ä¹ˆæ˜¯æŒ‡é’ˆ

æŒ‡é’ˆå¼æŒ‡å‘å¦ä¸€ä¸ªå˜é‡åœ°å€çš„å˜é‡ã€‚

Go è¯­è¨€çš„æŒ‡é’ˆåŒæ—¶ä¹Ÿå¼ºè°ƒå®‰å…¨æ€§ï¼Œä¸ä¼šå‡ºç°è¿·é€”æŒ‡é’ˆï¼ˆdangling pointersï¼‰

## & å’Œ * ç¬¦å·

å˜é‡ä¼šå°†å®ƒä»¬çš„å€¼å­˜å‚¨åœ¨è®¡ç®—æœºçš„ RAM é‡Œï¼Œ
å­˜å‚¨ä½ç½®å°±æ˜¯è¯¥å˜é‡çš„å†…å­˜åœ°å€ã€‚

`&` è¡¨ç¤ºåœ°å€æ“ä½œç¬¦ï¼Œé€šè¿‡ `&` å¯ä»¥è·å¾—å˜é‡çš„å†…å­˜åœ°å€ã€‚

```go
a := 100
fmt.Println(&a)  // è¾“å‡ºä¸€ä¸ªåœ°å€ï¼š0xc000122000
```

ä½†æ˜¯ï¼Œ`&` æ“ä½œç¬¦æ— æ³•è·å¾— **å­—ç¬¦ä¸²/æ•°å€¼/å¸ƒå°”å­—é¢å€¼** çš„åœ°å€ã€‚

```go
&42, &"hello"  // è¿™äº›éƒ½ä¼šå¯¼è‡´ç¼–è¯‘å™¨æŠ¥é”™
```

`*` æ“ä½œç¬¦ä¸ `&` çš„ä½œç”¨ç›¸åï¼Œå®ƒç”¨æ¥`è§£å¼•ç”¨`ï¼Œæä¾›å†…å­˜åœ°å€æŒ‡å‘çš„å€¼

```go
answer := 42
fmt.Println(&answer)
address := &answer
fmt.Println(*address)
// output
0xc0000180b0
42
```

### æ³¨æ„

C è¯­è¨€ä¸­çš„å†…å­˜åœ°å€å¯ä»¥é€šè¿‡ä¾‹å¦‚ address++ è¿™æ ·çš„æŒ‡é’ˆè¿ç®—è¿›è¡Œæ“ä½œï¼Œ
ä½†æ˜¯åœ¨ Go é‡Œé¢ä¸å…è®¸è¿™ç§ä¸å®‰å…¨æ“ä½œã€‚

## æŒ‡é’ˆç±»å‹

æŒ‡é’ˆå­˜å‚¨çš„æ˜¯å†…å­˜åœ°å€

```go
answer := 42
address := &answer // ç±»å‹ *int
fmt.Printf("address is a %T\n", address)  
// address is a *int
```

æŒ‡é’ˆç±»å‹å’Œå…¶å®ƒæ™®é€šç±»å‹ä¸€æ ·ï¼Œ
å‡ºç°åœ¨æ‰€æœ‰éœ€è¦ç”¨åˆ°ç±»å‹çš„åœ°æ–¹ï¼Œ
å¦‚ï¼šå˜é‡å£°æ˜ã€å‡½æ•°å½¢å‚ã€è¿”å›å€¼ç±»å‹ã€ç»“æ„ä½“å­—æ®µç­‰ã€‚

```go
canada := "Canada"

var home *string
fmt.Printf("home is a %T\n", home)

home = &canada
fmt.Println(home)

// output
home is a *string
0xc000014060
```

å°† `*` æ”¾åœ¨ç±»å‹å‰é¢è¡¨ç¤ºå£°æ˜æŒ‡é’ˆç±»å‹

å°† `*` æ”¾åœ¨å˜é‡å‰é¢è¡¨ç¤ºè§£å¼•ç”¨æ“ä½œ

ä¸¤ä¸ªæŒ‡é’ˆå˜é‡æŒæœ‰ç›¸åŒçš„å†…å­˜åœ°å€ï¼Œé‚£ä¹ˆå®ƒä»¬å°±æ˜¯ç›¸ç­‰

## æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆ

ä¸å­—ç¬¦ä¸²å’Œæ•°å€¼ä¸ä¸€æ ·ï¼Œå¤åˆå­—é¢é‡çš„å‰é¢å¯ä»¥æ”¾ç½® `&`

```go
type person struct {
    name, superpower string
    age              int
}

timmy := &person{
    name: "Timothy",
    age:  10,
}

(*timmy).superpower = "flying"  // è§£å¼•ç”¨åŠ ä¸åŠ éƒ½è¡Œ
timmy.superpower = "flying"

fmt.Printf("%+v\n", timmy)
// output
//&{name:Timothy superpower:flying age:10}
```

è®¿é—®å­—æ®µæ—¶ï¼Œå¯¹ç»“æ„ä½“è¿›è¡Œè§£å¼•ç”¨å¹¶ä¸æ˜¯å¿…é¡»çš„ã€‚

## æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ

å’Œç»“æ„ä½“ä¸€æ ·ï¼Œå¯ä»¥æŠŠ & æ”¾åœ¨æ•°ç»„çš„å¤åˆå­—é¢å€¼å‰é¢æ¥åˆ›å»ºæŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆã€‚

æ•°ç»„åœ¨æ‰§è¡Œç´¢å¼•æˆ–åˆ‡ç‰‡æ“ä½œæ—¶ä¼šè‡ªåŠ¨è§£å¼•ç”¨ã€‚æ²¡æœ‰å¿…è¦å†™ `(*superpower)[0]` è¿™ç§å½¢å¼ã€‚

ä¸ C è¯­è¨€ä¸ä¸€æ ·ï¼ŒGo é‡Œé¢æ•°ç»„å’ŒæŒ‡é’ˆæ˜¯ä¸¤ç§å®Œå…¨ç‹¬ç«‹çš„ç±»å‹ã€‚

Slice å’Œ map çš„å¤åˆå­—é¢å€¼å‰é¢ä¹Ÿå¯ä»¥æ”¾ç½® & æ“ä½œç¬¦ï¼Œä½†æ˜¯ Go å¹¶æ²¡æœ‰ä¸ºå®ƒä»¬æä¾›è‡ªåŠ¨è§£å¼•ç”¨çš„åŠŸèƒ½ã€‚

```go
superpowers := &[3]string{"flight", "invisibility", "super strength"}
fmt.Println(superpowers[0])
fmt.Println(superpowers[1:2])
// output
// flight
// [invisibility]
```

## å®ç°ä¿®æ”¹

Go è¯­è¨€çš„å‡½æ•°å’Œæ–¹æ³•éƒ½æ˜¯æŒ‰å€¼ä¼ é€’å‚æ•°çš„ï¼Œ
è¿™æ„å‘³ç€å‡½æ•°æ€»æ˜¯æ“ä½œäºè¢«ä¼ é€’å‚æ•°çš„å‰¯æœ¬ã€‚

å½“æŒ‡é’ˆè¢«ä¼ é€’åˆ°å‡½æ•°æ—¶ï¼Œå‡½æ•°å°†æ¥æ”¶ä¼ å…¥çš„å†…å­˜åœ°å€çš„å‰¯æœ¬ã€‚
ä¹‹åå‡½æ•°å¯ä»¥é€šè¿‡è§£å¼•ç”¨å†…å­˜åœ°å€æ¥ä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„å€¼ã€‚

```go
type person struct {
    name, superpower string
    age              int
} 

func birthday(p *person) {
    p.age++
}

func main() {
    rebecca := person{
        name:       "Rebecca",
        superpower: "imagination",
        age:        14,
    }
    birthday(&rebecca)
    fmt.Printf("%+v\n", rebecca)
	// {name:Rebecca superpower:imagination age:15}
}
```

## æŒ‡é’ˆæ¥æ”¶è€…

æ–¹æ³•çš„**æ¥æ”¶è€…**å’Œæ–¹æ³•çš„å‚æ•°åœ¨å¤„ç†æŒ‡é’ˆæ–¹é¢æ˜¯å¾ˆç›¸ä¼¼çš„ã€‚

```go
rebecca := person{
    name:       "Rebecca",
    superpower: "imagination",
    age:        14,
}
rebecca.birthday()
fmt.Printf("%+v\n", rebecca)
// {name:Rebecca superpower:imagination age:15}

nathan := person{
    name: "Nathan",
    age:  17,
}
nathan.birthday() // ä¹Ÿå¯ä»¥è°ƒç”¨ birthday()
fmt.Printf("%+v\n", nathan) 
// {name:Nathan superpower: age:18}
```

Go è¯­è¨€åœ¨å˜é‡é€šè¿‡ç‚¹æ ‡è®°æ³•è¿›è¡Œè°ƒç”¨çš„æ—¶å€™ï¼Œ è‡ªåŠ¨ä½¿ç”¨ `&` å–å¾—å˜é‡ çš„å†…å­˜åœ°å€ã€‚

- æ‰€ä»¥ä¸ç”¨å†™ `(&nathan).birthday()` è¿™ç§å½¢å¼ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œã€‚

### æ³¨æ„

ä½¿ç”¨æŒ‡é’ˆä½œä¸ºæ¥æ”¶è€…çš„ç­–ç•¥åº”è¯¥å§‹ç»ˆå¦‚ä¸€ï¼š

å¦‚æœä¸€ç§ç±»å‹çš„æŸäº›æ–¹æ³•éœ€è¦ç”¨åˆ°æŒ‡é’ˆä½œä¸ºæ¥æ”¶è€…ï¼Œ
å°±åº”è¯¥ä¸ºè¿™ç§ç±»å‹çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯ç”¨æŒ‡é’ˆä½œä¸ºæ¥æ”¶è€…ã€‚

## å†…éƒ¨æŒ‡é’ˆ

Go è¯­è¨€æä¾›äº†å†…éƒ¨æŒ‡é’ˆè¿™ç§ç‰¹æ€§ã€‚

å®ƒç”¨äºç¡®å®šç»“æ„ä½“ä¸­æŒ‡å®šå­—æ®µçš„å†…å­˜åœ°å€ã€‚

`&` æ“ä½œç¬¦ä¸ä»…å¯ä»¥è·å¾—ç»“æ„ä½“çš„å†…å­˜åœ°å€ï¼Œ
è¿˜å¯ä»¥è·å¾—ç»“æ„ä½“ä¸­æŒ‡å®šå­—æ®µçš„å†…å­˜åœ°å€ã€‚

```go
type stats struct {
	level             int
	endurance, health int
}

func levelUp(s *stats) {
	s.level++
	s.endurance = 42 + (14 * s.level)
	s.health = 5 * s.endurance
}

type character struct {
	name  string
	stats stats
}

func main() {
    player := character{
        name: "Matthias",
    }
    levelUp(&player.stats) // ç›´æ¥ä½¿ç”¨ . æ ‡è®°æ³• è¿”å›çš„å°±æ˜¯æŒ‡é’ˆ
    fmt.Printf("%+v\n", player.stats)
	// {level:1 endurance:56 health:280}
}
```

`&` æ“ä½œç¬¦ä¸ä»…å¯ä»¥è·å¾—ç»“æ„ä½“çš„å†…å­˜åœ°å€ï¼Œ
è¿˜å¯ä»¥è·å¾—ç»“æ„ä½“ä¸­æŒ‡å®šå­—æ®µçš„å†…å­˜åœ°å€ã€‚

## ä¿®æ”¹æ•°ç»„

å‡½æ•°é€šè¿‡æŒ‡é’ˆå¯¹æ•°ç»„çš„å…ƒç´ è¿›è¡Œä¿®æ”¹

```go
func reset(board *[8][8]rune) {
	board[0][0] = 'ğŸ˜Š'
}

func main() {
    var board [8][8]rune
    reset(&board)
    fmt.Printf("%c\n", board[0][0])
}
```

## éšå¼çš„æŒ‡é’ˆ

Go è¯­è¨€é‡Œä¸€äº›å†…ç½®çš„é›†åˆç±»å‹å°±åœ¨æš—ä¸­ä½¿ç”¨æŒ‡é’ˆã€‚

map åœ¨è¢«èµ‹å€¼æˆ–è€…è¢«ä½œä¸ºå‚æ•°ä¼ é€’çš„æ—¶å€™ä¸ä¼šè¢«å¤åˆ¶ã€‚ 
- map å°±æ˜¯ä¸€ç§éšå¼æŒ‡é’ˆã€‚

è¿™ç§å†™æ³•å°±æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼š
`func demolish(Planets *map[string]string)`

map çš„é”®å’Œå€¼éƒ½å¯ä»¥æ˜¯æŒ‡é’ˆç±»å‹

éœ€è¦å°†æŒ‡é’ˆæŒ‡å‘ map çš„æƒ…å†µå¹¶ä¸å¤šè§

## slice æŒ‡å‘æ•°ç»„

ä¹‹å‰è¯´è¿‡ slice æ˜¯æŒ‡å‘æ•°ç»„çš„çª—å£ï¼Œ
å®é™…ä¸Š slice åœ¨æŒ‡å‘æ•°ç»„å…ƒç´ çš„æ—¶å€™ä¹Ÿä½¿ç”¨äº†æŒ‡é’ˆã€‚

æ¯ä¸ª slice å†…éƒ¨éƒ½ä¼šè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªåŒ…å« 3 ä¸ªå…ƒç´ çš„ç»“æ„ï¼Œå®ƒä»¬åˆ†åˆ«æŒ‡å‘ï¼š

- æ•°ç»„çš„æŒ‡é’ˆ

- sliceçš„å®¹é‡ 

- sliceçš„é•¿åº¦

å½“ **slice è¢«ç›´æ¥ä¼ é€’è‡³å‡½æ•°æˆ–æ–¹æ³•æ—¶**ï¼Œ
slice çš„å†…éƒ¨æŒ‡é’ˆå°±å¯ä»¥**å¯¹åº•å±‚æ•°æ®è¿›è¡Œä¿®æ”¹**ã€‚

æŒ‡å‘ slice çš„**æ˜¾å¼æŒ‡é’ˆ**çš„å”¯ä¸€ä½œç”¨å°±æ˜¯**ä¿®æ”¹ slice æœ¬èº«**ï¼š
slice çš„é•¿åº¦ã€å®¹é‡ä»¥åŠèµ·å§‹åç§»é‡ã€‚

```go
func reclassify(planets *[]string) {
	*planets = (*planets)[1:8]
}

func main() {
    planets := []string{
        "Mercury", "Venus", "Earth", "Mars",
        "Jupiter", "Saturn", "Uranus", "Neptune",
        "Pluto",
    }
    reclassify(&planets)
    fmt.Println(planets) 
    // [Venus Earth Mars Jupiter Saturn Uranus Neptune]
}
```

## æŒ‡é’ˆå’Œæ¥å£

æœ¬ä¾‹ä¸­ï¼Œæ— è®º martian è¿˜æ˜¯æŒ‡å‘ martian çš„æŒ‡é’ˆéƒ½å¯ä»¥æ»¡è¶³ talker æ¥å£ã€‚

å¦‚æœæ–¹æ³•ä½¿ç”¨çš„æ˜¯æŒ‡é’ˆæ¥æ”¶è€…ï¼Œ
é‚£ä¹ˆæƒ…å†µä¼šæœ‰æ‰€ä¸åŒï¼šå› ä¸ºè¿™æ—¶æ˜¯**æŒ‡é’ˆç±»å‹**å®ç°äº†è¿™ä¸ªæ¥å£

## æ˜æ™ºçš„ä½¿ç”¨æŒ‡é’ˆ

åº”åˆç†ä½¿ç”¨æŒ‡é’ˆï¼Œä¸è¦è¿‡åº¦ä½¿ç”¨æŒ‡é’ˆ




